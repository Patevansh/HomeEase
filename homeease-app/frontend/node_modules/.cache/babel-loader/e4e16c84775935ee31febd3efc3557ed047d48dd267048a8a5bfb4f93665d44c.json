{"ast":null,"code":"// Utility to clean up invalid tokens and reset auth state\nexport const cleanupAuthState = () => {\n  const token = localStorage.getItem('homeease_token');\n  if (token) {\n    // Basic JWT format validation\n    const parts = token.split('.');\n    if (parts.length !== 3) {\n      console.log('Invalid token format detected, clearing auth state');\n      localStorage.removeItem('homeease_token');\n      return false;\n    }\n\n    // Check if token is expired or malformed by trying to decode\n    try {\n      const payload = JSON.parse(atob(parts[1]));\n      const currentTime = Date.now() / 1000;\n      if (payload.exp && payload.exp < currentTime) {\n        console.log('Token expired, clearing auth state');\n        localStorage.removeItem('homeease_token');\n        return false;\n      }\n      return true; // Token appears valid\n    } catch (error) {\n      console.log('Token decode failed, clearing auth state:', error);\n      localStorage.removeItem('homeease_token');\n      return false;\n    }\n  }\n  return false; // No token\n};\n\n// Force logout and clear all auth data\nexport const forceLogout = () => {\n  var _window$axios, _window$axios$default, _window$axios$default2, _window$axios$default3;\n  localStorage.removeItem('homeease_token');\n  localStorage.removeItem('user');\n  (_window$axios = window.axios) === null || _window$axios === void 0 ? true : (_window$axios$default = _window$axios.defaults) === null || _window$axios$default === void 0 ? true : (_window$axios$default2 = _window$axios$default.headers) === null || _window$axios$default2 === void 0 ? true : (_window$axios$default3 = _window$axios$default2.common) === null || _window$axios$default3 === void 0 ? true : delete _window$axios$default3['Authorization'];\n\n  // Reload page to reset app state\n  window.location.href = '/login';\n};","map":{"version":3,"names":["cleanupAuthState","token","localStorage","getItem","parts","split","length","console","log","removeItem","payload","JSON","parse","atob","currentTime","Date","now","exp","error","forceLogout","_window$axios","_window$axios$default","_window$axios$default2","_window$axios$default3","window","axios","defaults","headers","common","location","href"],"sources":["/mnt/53B95BA73C164FFE/HomeEase/homeease-app/frontend/src/utils/authUtils.js"],"sourcesContent":["// Utility to clean up invalid tokens and reset auth state\nexport const cleanupAuthState = () => {\n  const token = localStorage.getItem('homeease_token');\n  \n  if (token) {\n    // Basic JWT format validation\n    const parts = token.split('.');\n    if (parts.length !== 3) {\n      console.log('Invalid token format detected, clearing auth state');\n      localStorage.removeItem('homeease_token');\n      return false;\n    }\n    \n    // Check if token is expired or malformed by trying to decode\n    try {\n      const payload = JSON.parse(atob(parts[1]));\n      const currentTime = Date.now() / 1000;\n      \n      if (payload.exp && payload.exp < currentTime) {\n        console.log('Token expired, clearing auth state');\n        localStorage.removeItem('homeease_token');\n        return false;\n      }\n      \n      return true; // Token appears valid\n    } catch (error) {\n      console.log('Token decode failed, clearing auth state:', error);\n      localStorage.removeItem('homeease_token');\n      return false;\n    }\n  }\n  \n  return false; // No token\n};\n\n// Force logout and clear all auth data\nexport const forceLogout = () => {\n  localStorage.removeItem('homeease_token');\n  localStorage.removeItem('user');\n  delete window.axios?.defaults?.headers?.common?.['Authorization'];\n  \n  // Reload page to reset app state\n  window.location.href = '/login';\n};\n"],"mappings":"AAAA;AACA,OAAO,MAAMA,gBAAgB,GAAGA,CAAA,KAAM;EACpC,MAAMC,KAAK,GAAGC,YAAY,CAACC,OAAO,CAAC,gBAAgB,CAAC;EAEpD,IAAIF,KAAK,EAAE;IACT;IACA,MAAMG,KAAK,GAAGH,KAAK,CAACI,KAAK,CAAC,GAAG,CAAC;IAC9B,IAAID,KAAK,CAACE,MAAM,KAAK,CAAC,EAAE;MACtBC,OAAO,CAACC,GAAG,CAAC,oDAAoD,CAAC;MACjEN,YAAY,CAACO,UAAU,CAAC,gBAAgB,CAAC;MACzC,OAAO,KAAK;IACd;;IAEA;IACA,IAAI;MACF,MAAMC,OAAO,GAAGC,IAAI,CAACC,KAAK,CAACC,IAAI,CAACT,KAAK,CAAC,CAAC,CAAC,CAAC,CAAC;MAC1C,MAAMU,WAAW,GAAGC,IAAI,CAACC,GAAG,CAAC,CAAC,GAAG,IAAI;MAErC,IAAIN,OAAO,CAACO,GAAG,IAAIP,OAAO,CAACO,GAAG,GAAGH,WAAW,EAAE;QAC5CP,OAAO,CAACC,GAAG,CAAC,oCAAoC,CAAC;QACjDN,YAAY,CAACO,UAAU,CAAC,gBAAgB,CAAC;QACzC,OAAO,KAAK;MACd;MAEA,OAAO,IAAI,CAAC,CAAC;IACf,CAAC,CAAC,OAAOS,KAAK,EAAE;MACdX,OAAO,CAACC,GAAG,CAAC,2CAA2C,EAAEU,KAAK,CAAC;MAC/DhB,YAAY,CAACO,UAAU,CAAC,gBAAgB,CAAC;MACzC,OAAO,KAAK;IACd;EACF;EAEA,OAAO,KAAK,CAAC,CAAC;AAChB,CAAC;;AAED;AACA,OAAO,MAAMU,WAAW,GAAGA,CAAA,KAAM;EAAA,IAAAC,aAAA,EAAAC,qBAAA,EAAAC,sBAAA,EAAAC,sBAAA;EAC/BrB,YAAY,CAACO,UAAU,CAAC,gBAAgB,CAAC;EACzCP,YAAY,CAACO,UAAU,CAAC,MAAM,CAAC;EAC/B,CAAAW,aAAA,GAAOI,MAAM,CAACC,KAAK,cAAAL,aAAA,sBAAAC,qBAAA,GAAZD,aAAA,CAAcM,QAAQ,cAAAL,qBAAA,sBAAAC,sBAAA,GAAtBD,qBAAA,CAAwBM,OAAO,cAAAL,sBAAA,sBAAAC,sBAAA,GAA/BD,sBAAA,CAAiCM,MAAM,cAAAL,sBAAA,qBAA9C,OAAOA,sBAAA,CAA0C,eAAe,CAAC;;EAEjE;EACAC,MAAM,CAACK,QAAQ,CAACC,IAAI,GAAG,QAAQ;AACjC,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}